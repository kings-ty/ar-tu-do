# ğŸï¸ Advanced T-Pattern LiDAR Racing Controller

ROS2 ê¸°ë°˜ F1 ììœ¨ì£¼í–‰ ì‹œìŠ¤í…œìœ¼ë¡œ, TíŒ¨í„´ ë¼ì´ë‹¤ ìŠ¤ìºë‹ê³¼ ì ì‘ì  ì†ë„ ì œì–´ë¥¼ êµ¬í˜„í•œ ê³ ì„±ëŠ¥ ë ˆì´ì‹± ì»¨íŠ¸ë¡¤ëŸ¬ì…ë‹ˆë‹¤.

## ğŸš€ í•µì‹¬ ê¸°ìˆ 

### 1. **TíŒ¨í„´ ë¼ì´ë‹¤ ìŠ¤ìºë‹ ì‹œìŠ¤í…œ**
- **11ê°œ í¬ì¸íŠ¸ ë™ì‹œ ìŠ¤ìº”**: ì „ë°© 5ê°œ + ì¢Œìš° 6ê°œ ê°ë„
- **ì‹¤ì‹œê°„ ì½”ë„ˆ ì˜ˆì¸¡**: ì „ë°© 1-4m ê±°ë¦¬ë¡œ ì½”ë„ˆ ë¯¸ë¦¬ ê°ì§€
- **RViz ì‹œê°í™”**: ìƒ‰ìƒë³„ ë§ˆì»¤ì™€ ë ˆì´ì € ë¹” ì‹¤ì‹œê°„ í‘œì‹œ

```python
TíŒ¨í„´ êµ¬ì„±:
ì „ë°©(ì„¸ë¡œ): 0Â°, Â±5Â°, Â±10Â° (ì½”ë„ˆ ê°ì§€)
ì¢Œìš°(ê°€ë¡œ): Â±90Â°, Â±60Â°, Â±45Â° (ë²½ ì¶”ì¢…)
```

### 2. **ì ì‘ì  ì†ë„ ì œì–´ ì•Œê³ ë¦¬ì¦˜**
- **4ë‹¨ê³„ ìë™ ì†ë„ ì¡°ì ˆ**
  - ğŸŸ¢ **ì¥ì§ì„ ** (4m+): ìµœëŒ€ 60km/h
  - ğŸ”µ **ì¼ë°˜ì§ì„ ** (2-4m): ê¸°ë³¸ 40km/hì˜ 80-120%
  - ğŸŸ¡ **ì½”ë„ˆ** (1.2-2m): 20-32km/h
  - ğŸ”´ **ê¸‰ì½”ë„ˆ** (1.2m ë¯¸ë§Œ): ìµœì†Œ 15km/h

### 3. **ë©€í‹°ëª¨ë‹¬ ì„¼ì„œ ìœµí•©**
- **ë¼ì´ë‹¤**: TíŒ¨í„´ ê±°ë¦¬ ì¸¡ì • + ë²½ ì¶”ì¢…
- **ì¹´ë©”ë¼**: ë© ì²´í¬ ë¼ì¸ ê°ì§€ (OpenCV)
- **IMU**: ì°¨ëŸ‰ ìì„¸ ë°ì´í„°

### 4. **Ackermann ì¡°í–¥ ê¸°í•˜í•™**
- ë¬¼ë¦¬ì ìœ¼ë¡œ ì •í™•í•œ ì•ë°”í€´ ì°¨ë™ ì¡°í–¥ê° ê³„ì‚°
- íœ ë² ì´ìŠ¤/íŠ¸ë™í­ ê¸°ë°˜ ì¡°í–¥ ì•ˆì •ì„± ìµœì í™”

## ğŸ“Š ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§

í„°ë¯¸ë„ì—ì„œ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆëŠ” ì •ë³´:

```
============================================================
ğŸ¯ TíŒ¨í„´ ë¼ì´ë‹¤ ë¶„ì„:
ì „ë°© ìŠ¤ìº”: 0Â°=2.33m, Â±5Â°=(1.96, 2.86)m, Â±10Â°=(1.68, 3.72)m
ì¢Œìš° ìŠ¤ìº”: 90Â°=0.72m, -90Â°=0.68m
í˜„ì¬ íŠ¸ë™ í­: 1.40m
ğŸ”„ ì½”ë„ˆ ê°ì§€! (ì „ë°© ìµœì†Œê±°ë¦¬: 1.96m)
ë© ì²´í¬ ë¼ì¸: âŒ ì—†ìŒ
ğŸš— ì†ë„ ì œì–´: ì½”ë„ˆ | ì „ë°©ê±°ë¦¬: 1.68m | ì†ë„: 27.2 (68.1%)
============================================================
```

## ğŸ› ï¸ ì„¤ì¹˜ ë° ì‹¤í–‰

### í™˜ê²½ ìš”êµ¬ì‚¬í•­
- ROS2 (Humble/Foxy)
- Python 3.8+
- OpenCV 4.x
- NumPy, SciPy

### ì‹¤í–‰ ë°©ë²•

1. **ì‹œë®¬ë ˆì´ì…˜ í™˜ê²½ ì‹œì‘**
```bash
# Gazebo + RViz ì‹¤í–‰
ros2 launch f1tenth_gym_ros gym_bridge_launch.py
```

2. **TíŒ¨í„´ ì»¨íŠ¸ë¡¤ëŸ¬ ì‹¤í–‰**
```bash
cd /home/ty/f1test_ws/ar-tu-do
source install/setup.bash
python3 ros_ws/src/autonomous/move_to_center_supervised/move_to_center.py
```

3. **RViz ì‹œê°í™” ì„¤ì •**
- Fixed Frame: `base_link`
- LaserScan Topic: `/scan` (Size: 0.05)
- MarkerArray Topic: `/t_pattern_markers` (TíŒ¨í„´ ì‹œê°í™”)

## ğŸ¯ RViz ì‹œê°í™”

### ë§ˆì»¤ ìƒ‰ìƒ ì˜ë¯¸
- ğŸ”´ **ë¹¨ê°„ êµ¬**: ì •ë©´ 0ë„ (ê°€ì¥ ì¤‘ìš”)
- ğŸŸ  **ì£¼í™© êµ¬**: ì „ë°© Â±5Â°, Â±10Â° (ì½”ë„ˆ ê°ì§€ìš©)
- ğŸ”µ **íŒŒë€ êµ¬**: ì¢Œìš° Â±90Â° (ë²½ ê±°ë¦¬)
- ğŸŸ¢ **ë…¹ìƒ‰ êµ¬**: ê¸°íƒ€ ê°ë„ (Â±45Â°, Â±60Â°)
- íšŒìƒ‰ ì„ : ì°¨ëŸ‰ì—ì„œ ê° í¬ì¸íŠ¸ê¹Œì§€ì˜ ë ˆì´ì € ë¹”

## âš™ï¸ ì£¼ìš” íŒŒë¼ë¯¸í„°

```python
# ì†ë„ ì œì–´ ì„¤ì •
BASE_SPEED = 40.0          # ê¸°ë³¸ ì†ë„ (km/h)
MAX_SPEED = 60.0           # ìµœëŒ€ ì†ë„ (ì§ì„ )
MIN_SPEED = 15.0           # ìµœì†Œ ì†ë„ (ê¸‰ì½”ë„ˆ)

# TíŒ¨í„´ ê±°ë¦¬ ì„ê³„ê°’
STRAIGHT_DISTANCE = 4.0    # ì§ì„  íŒë‹¨ ê±°ë¦¬
CORNER_DISTANCE = 2.0      # ì½”ë„ˆ íŒë‹¨ ê±°ë¦¬
SHARP_CORNER_DISTANCE = 1.2 # ê¸‰ì½”ë„ˆ íŒë‹¨ ê±°ë¦¬

# ì°¨ëŸ‰ ë¬¼ë¦¬ íŒŒë¼ë¯¸í„°
WHEEL_BASE = 0.32          # íœ ë² ì´ìŠ¤ (m)
WHEEL_TRACK = 0.211        # íŠ¸ë™í­ (m)
MAX_STEERING_ANGLE = 0.3   # ìµœëŒ€ ì¡°í–¥ê° (rad)
```

## ğŸ“ˆ ì„±ëŠ¥ íŠ¹ì§•

### ì†ë„ í”„ë¡œíŒŒì¼
- **ì§ì„  êµ¬ê°„**: ìµœëŒ€ 60km/hë¡œ ê³ ì† ì£¼í–‰
- **ì½”ë„ˆ ì§„ì…**: ê±°ë¦¬ ê¸°ë°˜ ì ì§„ì  ê°ì†
- **ê¸‰ì½”ë„ˆ**: 15km/hê¹Œì§€ ì•ˆì „ ê°ì†
- **ë© ë¼ì¸**: ìë™ 30% ê°ì†

### ì•ˆì „ì„± ê¸°ëŠ¥
- ì‹¤ì‹œê°„ ì „ë°© ì¥ì• ë¬¼ ê°ì§€
- ì¢Œìš° ê· í˜•ë„ ê¸°ë°˜ ì†ë„ ë³´ì •
- ë¬¼ë¦¬ì  ì¡°í–¥ ê°ë„ ì œí•œ
- ë²½ ì¶©ëŒ ë°©ì§€ ì•Œê³ ë¦¬ì¦˜

## ğŸ”§ ê³ ê¸‰ ê¸°ëŠ¥

### 1. **ë°ì´í„° ìˆ˜ì§‘ ëª¨ë“œ**
```bash
python supervised_data_collector.py --speed 50 --duration 300
```

### 2. **ì„±ëŠ¥ ë¶„ì„ ë„êµ¬**
```bash
python test_data_collector.py  # ë°ì´í„° í’ˆì§ˆ ë¶„ì„
python compression_benchmark.py  # ì••ì¶• ì„±ëŠ¥ í…ŒìŠ¤íŠ¸
```

### 3. **ì‹ ê²½ë§ í•™ìŠµ** (ê°œë°œ ì¤‘)
```bash
python supervised_trainer.py  # ë”¥ëŸ¬ë‹ ëª¨ë¸ í•™ìŠµ
python f1_neural_network.py   # ì‹ ê²½ë§ ì¶”ë¡  ëª¨ë“œ
```

## ğŸ ì•Œê³ ë¦¬ì¦˜ ìƒì„¸

### TíŒ¨í„´ ë ˆì´ìºìŠ¤íŒ…
```python
def calculate_adaptive_speed(self, t_data):
    # ì „ë°© 5ê°œ ê°ë„ì—ì„œ ê±°ë¦¬ ì¸¡ì •
    forward_distances = [t_data[angle] for angle in [0, Â±5, Â±10]]
    min_distance = min(forward_distances)
    
    # ê±°ë¦¬ ê¸°ë°˜ ì†ë„ ê³„ì‚°
    if min_distance >= 4.0:      # ì¥ì§ì„ 
        speed = MAX_SPEED * 1.5
    elif min_distance >= 2.0:    # ì¼ë°˜ì§ì„ 
        speed = BASE_SPEED * (0.8 + 0.4 * ratio)
    elif min_distance >= 1.2:    # ì½”ë„ˆ
        speed = BASE_SPEED * (0.5 + 0.3 * ratio)
    else:                        # ê¸‰ì½”ë„ˆ
        speed = MAX(MIN_SPEED, BASE_SPEED * 0.4)
```

### Ackermann ì¡°í–¥
```python
def calculate_ackermann_steering(self, center_angle):
    angle_outer = atan(wheelbase / (wheelbase/tan(center_angle) + track_width))
    angle_inner = atan(wheelbase / (wheelbase/tan(center_angle) - track_width))
```

## ğŸ“ ë¡œê·¸ ë¶„ì„

ì‹¤ì‹œê°„ ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§ì„ ìœ„í•œ ë¡œê·¸ ë¶„ì„:
- ì½”ë„ˆ/ì§ì„  ê°ì§€ ì •í™•ë„
- ì†ë„ ë³€í™” íŒ¨í„´
- ì¡°í–¥ê° ì•ˆì •ì„±
- ë© íƒ€ì„ ì„±ëŠ¥

## ğŸ® ì»¤ìŠ¤í„°ë§ˆì´ì§•

ì†ë„ì™€ ì£¼í–‰ ìŠ¤íƒ€ì¼ì„ ì›í•˜ëŠ” ëŒ€ë¡œ ì¡°ì •:

```python
# ê³µê²©ì  ë ˆì´ì‹± ëª¨ë“œ
BASE_SPEED = 60.0
MAX_SPEED = 80.0
CORNER_DISTANCE = 1.5

# ì•ˆì „ ì£¼í–‰ ëª¨ë“œ  
BASE_SPEED = 30.0
MAX_SPEED = 45.0
CORNER_DISTANCE = 3.0
```

## ğŸ“š ì°¸ê³  ìë£Œ

- [F1TENTH ê³µì‹ ë¬¸ì„œ](https://f1tenth.org/)
- [ROS2 LaserScan ë©”ì‹œì§€](https://docs.ros2.org/latest/api/sensor_msgs/msg/LaserScan.html)
- [Ackermann ì¡°í–¥ ê¸°í•˜í•™](https://en.wikipedia.org/wiki/Ackermann_steering_geometry)

---

**ğŸ† Created by**: Advanced Autonomous Racing Team  
**ğŸ“… Updated**: 2025-10-06  
**ğŸ”§ ROS2**: Humble/Foxy Compatible  
**ğŸ¯ Purpose**: High-Performance Autonomous F1 Racing